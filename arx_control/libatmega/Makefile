#------------------------------------------------------------------------------
# Main Targets
#------------------------------------------------------------------------------
all: LIBATMEGA

#------------------------------------------------------------------------------
# Config
#------------------------------------------------------------------------------
OS=$(shell uname)

#------------------------------------------------------------------------------
# Compiler
#------------------------------------------------------------------------------

# C++ Compiler and Linker Executable
CXX     := $(CROSS)g++


#------------------------------------------------------------------------------
# Inc && Lib 
#------------------------------------------------------------------------------
LDLIB   := -ludev

#------------------------------------------------------------------------------
# Compiler Flags 
#------------------------------------------------------------------------------
CXXFLAGS  := -O2 -Wall -std=c++17 -Werror -g -fPIC -I.

#------------------------------------------------------------------------------
# Linker Flags 
#------------------------------------------------------------------------------
LFLAGS  := -fPIC


#------------------------------------------------------------------------------
# Common rules
#------------------------------------------------------------------------------
%.o:	%.cpp 
	$(CXX) -c $(CXXFLAGS) -o $@ $<


#------------------------------------------------------------------------------
# Target Builds
# 
#------------------------------------------------------------------------------
LIBATMEGA : libatmega.a #libatmega.so
libatmega.a : libatmega.o
	ar -rcsv $@ $^
libatmega.so: libatmega.o
	$(CXX) -shared -Wl,-soname,$@ -o $@ libatmega.o

clean:
	@echo $(OS) Clean
	rm -f *.o *.a *.so
